INSERT INTO public.requette (id,coder,dateconverti,dateexecution,dateinsert,etat,requettefr,requettesql,resultat) VALUES 
(11,'requette2',NULL,NULL,'2017-08-27 16:34:16.499',NULL,'Afficher le chiffre d''ffaires des 5 dernières années apartir de 2010 ','with table_chaque_year as ( select distinct (anneetmp)as annee from dim_temps where anneetmp>=''2010'' order by anneetmp asc) select d.annee, sum(montantvente)as chiffre_d_affaire from fait_vente v, dim_temps t, table_chaque_year d where v.pktmp=t.id and t.anneetmp=d.annee group by d.annee order by d.annee asc ;',NULL)
,(12,'requette3',NULL,NULL,'2017-08-27 16:34:16.499',NULL,'Afficher l''évolution des ventes de chaque mois pour l''année 2011','with table_chaque_mois as ( select distinct (moisnomtmp), moistmp as mois from dim_temps order by moistmp asc) select d.moisnomtmp as Anne_2012, sum(montantvente)as chiffre_d_affaire from fait_vente v, dim_temps t, table_chaque_mois d  where v.pktmp=t.id and t.moistmp=d.mois and t.anneetmp=''2012'' group by d.mois, d.moisnomtmp order by d.mois asc',NULL)
,(13,'requette4',NULL,NULL,'2017-08-27 16:34:16.499',NULL,'Afficher la liste des produits les plus achetés','select count(v.pkart) as nombre_article, ar.designationart from fait_vente v, dim_article ar where v.pkart=ar.id group by v.pkart, ar.designationart having count(v.pkart)>10 order by nombre_article desc',NULL)
,(15,'requette5',NULL,NULL,'2017-08-27 16:39:29.894',NULL,'Afficher la liste des articles qui existent','select a.id, prixvente from dim_article a',NULL)
,(10,'requette1',NULL,NULL,'2017-08-27 16:34:16.499',NULL,'Afficher le chiffre d''affaire de l''année précédente.','select sum(montantvente) from fait_vente v, dim_temps t where v.pktmp=t.id and t.anneetmp=date_part(''year'', CURRENT_DATE) - 4',NULL)
;